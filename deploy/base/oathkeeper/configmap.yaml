apiVersion: v1
kind: ConfigMap
metadata:
  name: oathkeeper-config
  namespace: naytife-auth
  labels:
    app.kubernetes.io/name: oathkeeper
    app.kubernetes.io/part-of: naytife-platform
data:
  config.yaml: |
    log:
      level: info
      format: json
      leak_sensitive_values: true
    
    serve:
      proxy:
        port: 8080
        host: 0.0.0.0
        cors:
          enabled: true
          allowed_origins:
            - "*"
          allowed_methods:
            - POST
            - GET
            - PUT
            - PATCH
            - DELETE
          allowed_headers:
            - "*"
      api:
        port: 4456
        host: 0.0.0.0
    
    access_rules:
      matching_strategy: glob
      repositories:
        - file:///etc/rules/access-rules.json
    
    errors:
      fallback:
        - json
      handlers:
        json:
          enabled: true
          config:
            verbose: true
        redirect:
          enabled: true
          config:
            to: http://127.0.0.1:3000/auth/login
            when:
              - error:
                  - unauthorized
                  - forbidden
                request:
                  header:
                    accept:
                      - text/html
    
    authenticators:
      anonymous:
        enabled: true
        config:
          subject: guest
      
      noop:
        enabled: true
      
      oauth2_introspection:
        enabled: true
        config:
          introspection_url: http://hydra-admin.naytife-auth.svc.cluster.local:4445/admin/oauth2/introspect
          scope_strategy: exact
          trusted_issuers:
            - http://127.0.0.1:8080/
          pre_authorization:
            enabled: true
            client_id: ${OAUTH2_CLIENT_ID}
            client_secret: ${OAUTH2_CLIENT_SECRET}
            scope:
              - introspect
            token_url: http://hydra-public.naytife-auth.svc.cluster.local:4444/oauth2/token
          token_from:
            header: Authorization
          retry:
            max_delay: 300ms
            give_up_after: 2s
          cache:
            enabled: true
            ttl: 60s
      
      jwt:
        enabled: true
        config:
          jwks_urls:
            - http://hydra-public.naytife-auth.svc.cluster.local:4444/.well-known/jwks.json
          allowed_algorithms:
            - RS256
          trusted_issuers:
            - http://127.0.0.1:8080/
    
    authorizers:
      allow:
        enabled: true
      
      deny:
        enabled: true
    
    mutators:
      noop:
        enabled: true
      
      header:
        enabled: true
        config:
          headers:
            X-User-Id: "{{ print .Subject }}"
            X-User-Email: "{{ print .Extra.email }}"
            X-User-Name: "{{ print .Extra.name }}"
  access-rules.json: |
    [
      {
        "id":"api:rest-api-docs",
        "upstream": {
          "preserve_host": true,
          "url": "http://backend.naytife:8000"
        },
        "match": {
          "url": "http://127.0.0.1:8080/v1/docs",
          "methods": [
            "GET"
          ]
        },
        "authenticators": [
          {
            "handler": "anonymous"
          }
        ],
        "authorizer": {
          "handler": "allow"
        }, 
        "mutators": [
          {
            "handler": "noop"
          }
        ]
      },
      {
        "id":"api:rest-api-docs-all",
        "upstream": {
          "preserve_host": true,
          "url": "http://backend.naytife:8000"
        },
        "match": {
          "url": "http://127.0.0.1:8080/v1/docs/<**>",
          "methods": [
            "GET"
          ]
        },
        "authenticators": [
          {
            "handler": "anonymous"
          }
        ],
        "authorizer": {
          "handler": "allow"
        }, 
        "mutators": [
          {
            "handler": "noop"
          }
        ]
      },
      {
        "id": "api:user-register",
        "upstream": {
          "preserve_host": true,
          "url": "http://backend.naytife:8000"
        },
        "match": {
          "url": "http://127.0.0.1:8080/v1/auth/register",
          "methods": [
            "POST"
          ]
        },
        "authenticators": [
          {
            "handler": "anonymous"
          }
        ],
        "authorizer": {
          "handler": "allow"
        },
        "mutators": [
          {
            "handler": "noop"
          }
        ]
      },
      {
        "id": "api:user-login",
        "upstream": {
          "preserve_host": true,
          "url": "http://backend.naytife:8000"
        },
        "match": {
          "url": "http://127.0.0.1:8080/v1/auth/login",
          "methods": [
            "POST"
          ]
        },
        "authenticators": [
          {
            "handler": "anonymous"
          }
        ],
        "authorizer": {
          "handler": "allow"
        },
        "mutators": [
          {
            "handler": "noop"
          }
        ]
      },
      {
        "id": "api:user-refresh",
        "upstream": {
          "preserve_host": true,
          "url": "http://backend.naytife:8000"
        },
        "match": {
          "url": "http://127.0.0.1:8080/v1/auth/refresh",
          "methods": [
            "POST"
          ]
        },
        "authenticators": [
          {
            "handler": "anonymous"
          }
        ],
        "authorizer": {
          "handler": "allow"
        },
        "mutators": [
          {
            "handler": "noop"
          }
        ]
      },
      {
        "id": "api:user-logout",
        "upstream": {
          "preserve_host": true,
          "url": "http://backend.naytife:8000"
        },
        "match": {
          "url": "http://127.0.0.1:8080/v1/auth/logout",
          "methods": [
            "POST"
          ]
        },
        "authenticators": [
          {
            "handler": "oauth2_introspection"
          }
        ],
        "authorizer": {
          "handler": "allow"
        },
        "mutators": [
          {
            "handler": "header"
          }
        ]
      },
      {
        "id": "api:user-profile",
        "upstream": {
          "preserve_host": true,
          "url": "http://backend.naytife:8000"
        },
        "match": {
          "url": "http://127.0.0.1:8080/v1/auth/profile",
          "methods": [
            "GET",
            "PUT"
          ]
        },
        "authenticators": [
          {
            "handler": "oauth2_introspection"
          }
        ],
        "authorizer": {
          "handler": "allow"
        },
        "mutators": [
          {
            "handler": "header"
          }
        ]
      },
      {
        "id": "api:cors",
        "upstream": {
          "preserve_host": true,
          "url": "http://backend.naytife:8000"
        },
        "match": {
          "url": "http://127.0.0.1:8080/<**>",
          "methods": [
            "OPTIONS"
          ]
        },
        "authenticators": [
          {
            "handler": "noop"
          }
        ],
        "authorizer": {
          "handler": "allow"
        },
        "mutators": [
          {
            "handler": "header",
            "config": {
              "headers": {
                "Access-Control-Allow-Origin": "*",
                "Access-Control-Allow-Methods": "GET, POST, PUT, DELETE, OPTIONS",
                "Access-Control-Allow-Headers": "Authorization, Content-Type"
              }
            }
          }
        ]
      },
      {
        "id": "api:customer-register",
        "upstream": {
          "preserve_host": true,
          "url": "http://backend.naytife:8000"
        },
        "match": {
          "url": "http://127.0.0.1:8080/v1/auth/register-customer",
          "methods": [
            "POST"
          ]
        },
        "authenticators": [
          {
            "handler": "anonymous"
          }
        ],
        "authorizer": {
          "handler": "allow"
        },
        "mutators": [
          {
            "handler": "noop"
          }
        ]
      },
      {
        "id": "api:customerinfo-public",
        "upstream": {
          "preserve_host": true,
          "url": "http://backend.naytife:8000"
        },
        "match": {
          "url": "http://127.0.0.1:8080/v1/customerinfo<**>",
          "methods": [
            "GET"
          ]
        },
        "authenticators": [
          {
            "handler": "anonymous"
          }
        ],
        "authorizer": {
          "handler": "allow"
        },
        "mutators": [
          {
            "handler": "noop"
          }
        ]
      },
      {
        "id": "api:webhooks-public",
        "upstream": {
          "preserve_host": true,
          "url": "http://backend.naytife:8000"
        },
        "match": {
          "url": "http://127.0.0.1:8080/v1/webhooks/<**>",
          "methods": [
            "POST"
          ]
        },
        "authenticators": [
          {
            "handler": "anonymous"
          }
        ],
        "authorizer": {
          "handler": "allow"
        },
        "mutators": [
          {
            "handler": "noop"
          }
        ]
      },
      {
        "id": "api:health-endpoints",
        "upstream": {
          "preserve_host": true,
          "url": "http://backend.naytife:8000"
        },
        "match": {
          "url": "http://127.0.0.1:8080/<{health,ready}>",
          "methods": [
            "GET"
          ]
        },
        "authenticators": [
          {
            "handler": "anonymous"
          }
        ],
        "authorizer": {
          "handler": "allow"
        },
        "mutators": [
          {
            "handler": "noop"
          }
        ]
      },
      {
        "id": "api:shop-order",
        "upstream": {
          "preserve_host": true,
          "url": "http://backend.naytife:8000"
        },
        "match": {
          "url": "http://127.0.0.1:8080/v1/shops/<*>/orders",
          "methods": ["POST", "GET"]
        },
        "authenticators": [
          { "handler": "anonymous" },
          { "handler": "oauth2_introspection" }
        ],
        "authorizer": { "handler": "allow" },
        "mutators": [
          { "handler": "noop" }
        ]
      },
      {
        "id": "api:shop-orders",
        "upstream": {
          "preserve_host": true,
          "url": "http://backend.naytife:8000"
        },
        "match": {
          "url": "http://127.0.0.1:8080/v1/shops/<*>/orders/<**>",
          "methods": ["DELETE", "GET", "PATCH", "PUT"]
        },
        "authenticators": [
          {
            "handler": "oauth2_introspection"
          }
        ],
        "authorizer": {
          "handler": "allow"
        },
        "mutators": [
          {
            "handler": "header",
            "config": {
              "headers": {
                "X-User-Id": "{{ print .Subject }}",
                "Access-Control-Allow-Origin": "*",
                "Access-Control-Allow-Methods": "GET, POST, PUT, DELETE, OPTIONS",
                "Access-Control-Allow-Headers": "Authorization, Content-Type"
              }
            }
          }
        ]
      },
      {
        "id": "api:shops-post-get",
        "upstream": {
          "preserve_host": true,
          "url": "http://backend.naytife:8000"
        },
        "match": {
          "url": "http://127.0.0.1:8080/v1/shops",
          "methods": [
            "GET",
            "POST"
          ]
        },
        "authenticators": [
          {
            "handler": "oauth2_introspection"
          }
        ],
        "authorizer": {
          "handler": "allow"
        },
        "mutators": [
          {
            "handler": "header",
            "config": {
              "headers": {
                "X-User-Id": "{{ print .Subject }}",
                "Access-Control-Allow-Origin": "*",
                "Access-Control-Allow-Methods": "GET, POST, PUT, DELETE, OPTIONS",
                "Access-Control-Allow-Headers": "Authorization, Content-Type"
              }
            }
          }
        ]
      },
      {
        "id": "api:shop-crud",
        "upstream": {
          "preserve_host": true,
          "url": "http://backend.naytife:8000"
        },
        "match": {
          "url": "http://127.0.0.1:8080/v1/shops/<*>",
          "methods": [
            "GET",
            "PUT",
            "DELETE"
          ]
        },
        "authenticators": [
          {
            "handler": "oauth2_introspection"
          }
        ],
        "authorizer": {
          "handler": "allow"
        },
        "mutators": [
          {
            "handler": "header",
            "config": {
              "headers": {
                "X-User-Id": "{{ print .Subject }}",
                "Access-Control-Allow-Origin": "*",
                "Access-Control-Allow-Methods": "GET, POST, PUT, DELETE, OPTIONS",
                "Access-Control-Allow-Headers": "Authorization, Content-Type"
              }
            }
          }
        ]
      },
      {
        "id": "api:admin-shop-apis",
        "upstream": {
          "preserve_host": true,
          "url": "http://backend.naytife:8000"
        },
        "match": {
          "url": "http://127.0.0.1:8080/v1/shops/<*>/<{customers,inventory,payment-methods,products,product-types,attributes,deploy,redeploy,deployment-status,update-data,images}><**>",
          "methods": [
            "GET",
            "POST",
            "PUT",
            "DELETE",
            "PATCH"
          ]
        },
        "authenticators": [
          {
            "handler": "oauth2_introspection"
          }
        ],
        "authorizer": {
          "handler": "allow"
        },
        "mutators": [
          {
            "handler": "header",
            "config": {
              "headers": {
                "X-User-Id": "{{ print .Subject }}",
                "Access-Control-Allow-Origin": "*",
                "Access-Control-Allow-Methods": "GET, POST, PUT, DELETE, OPTIONS",
                "Access-Control-Allow-Headers": "Authorization, Content-Type"
              }
            }
          }
        ]
      },
      {
        "id": "api:admin-protected-endpoints",
        "upstream": {
          "preserve_host": true,
          "url": "http://backend.naytife:8000"
        },
        "match": {
          "url": "http://127.0.0.1:8080/v1/<{me,userinfo,cart,checkout,images,predefined-product-types,subdomains}><**>",
          "methods": [
            "GET",
            "POST",
            "PUT",
            "DELETE",
            "PATCH"
          ]
        },
        "authenticators": [
          {
            "handler": "oauth2_introspection"
          }
        ],
        "authorizer": {
          "handler": "allow"
        },
        "mutators": [
          {
            "handler": "header",
            "config": {
              "headers": {
                "X-User-Id": "{{ print .Subject }}",
                "Access-Control-Allow-Origin": "*",
                "Access-Control-Allow-Methods": "GET, POST, PUT, DELETE, OPTIONS",
                "Access-Control-Allow-Headers": "Authorization, Content-Type"
              }
            }
          }
        ]
      },
      {
        "id": "api:public-graph-playground",
        "upstream": {
          "preserve_host": true,
          "url": "http://backend.naytife:8000"
        },
        "match": {
          "url": "http://<*>.localhost:8080/graph",
          "methods": [
            "GET"
          ]
        },
        "authenticators": [
          {
            "handler": "anonymous"
          }
        ],
        "authorizer": {
          "handler": "allow"
        },
        "mutators": [
          {
            "handler": "noop"
          }
        ]
      },
      {
        "id": "api:public-graph-query",
        "upstream": {
          "preserve_host": true,
          "url": "http://backend.naytife:8000"
        },
        "match": {
          "url": "http://<*>.localhost:8080/query",
          "methods": [
            "GET",
            "POST",
            "OPTIONS"
          ]
        },
        "authenticators": [
          {
            "handler": "anonymous"
          },
          {
            "handler": "jwt"
          }
        ],
        "authorizer": {
          "handler": "allow"
        },
        "mutators": [
          {
            "handler": "noop"
          }
        ]
      },
      {
        "id": "oauth:auth-endpoint",
        "upstream": {
          "preserve_host": true,
          "url": "http://hydra-public.naytife-auth:4444"
        },
        "match": {
          "url": "http://127.0.0.1:8080/oauth2/auth",
          "methods": [
            "GET"
          ]
        },
        "authenticators": [
          {
            "handler": "anonymous"
          }
        ],
        "authorizer": {
          "handler": "allow"
        },
        "mutators": [
          {
            "handler": "noop"
          }
        ]
      },
      {
        "id": "oauth:fallbacks-error-endpoint",
        "upstream": {
          "preserve_host": true,
          "url": "http://hydra-public.naytife-auth:4444"
        },
        "match": {
          "url": "http://127.0.0.1:8080/oauth2/fallbacks/error",
          "methods": [
            "GET"
          ]
        },
        "authenticators": [
          {
            "handler": "anonymous"
          }
        ],
        "authorizer": {
          "handler": "allow"
        },
        "mutators": [
          {
            "handler": "noop"
          }
        ]
      },
      {
        "id": "oauth:token-endpoint",
        "upstream": {
          "preserve_host": true,
          "url": "http://hydra-public.naytife-auth:4444"
        },
        "match": {
          "url": "http://127.0.0.1:8080/oauth2/token",
          "methods": [
            "POST",
            "OPTIONS"
          ]
        },
        "authenticators": [
          {
            "handler": "noop"
          }
        ],
        "authorizer": {
          "handler": "allow"
        },
        "mutators": [
          {
            "handler": "noop"
          }
        ]
      },
      {
        "id": "oauth:userinfo-endpoint",
        "upstream": {
          "preserve_host": true,
          "url": "http://hydra-public.naytife-auth:4444"
        },
        "match": {
          "url": "http://127.0.0.1:8080/userinfo",
          "methods": [
            "GET",
            "POST"
          ]
        },
        "authenticators": [
          {
            "handler": "oauth2_introspection"
          }
        ],
        "authorizer": {
          "handler": "allow"
        },
        "mutators": [
          {
            "handler": "noop"
          }
        ]
      },
      {
        "id": "oauth:logout-endpoint",
        "upstream": {
          "preserve_host": true,
          "url": "http://hydra-public.naytife-auth:4444"
        },
        "match": {
          "url": "http://127.0.0.1:8080/oauth2/sessions/logout",
          "methods": [
            "GET"
          ]
        },
        "authenticators": [
          {
            "handler": "oauth2_introspection"
          }
        ],
        "authorizer": {
          "handler": "allow"
        },
        "mutators": [
          {
            "handler": "noop"
          }
        ]
      },
      {
        "id": "oidc:well-known",
        "upstream": {
          "preserve_host": true,
          "url": "http://hydra-public.naytife-auth:4444"
        },
        "match": {
          "url": "http://127.0.0.1:8080/.well-known/openid-configuration",
          "methods": [
            "GET"
          ]
        },
        "authenticators": [
          {
            "handler": "anonymous"
          }
        ],
        "authorizer": {
          "handler": "allow"
        },
        "mutators": [
          {
            "handler": "noop"
          }
        ]
      },
      {
        "id": "oauth:login-endpoint",
        "upstream": {
          "preserve_host": true,
          "url": "http://auth-handler.naytife-auth:3000"
        },
        "match": {
          "url": "http://127.0.0.1:8080/login",
          "methods": [
            "GET",
            "POST"
          ]
        },
        "authenticators": [
          {
            "handler": "anonymous"
          }
        ],
        "authorizer": {
          "handler": "allow"
        },
        "mutators": [
          {
            "handler": "noop"
          }
        ]
      },
      {
        "id": "oauth:consent-endpoint",
        "upstream": {
          "preserve_host": true,
          "url": "http://auth-handler.naytife-auth:3000"
        },
        "match": {
          "url": "http://127.0.0.1:8080/consent",
          "methods": [
            "GET",
            "POST"
          ]
        },
        "authenticators": [
          {
            "handler": "anonymous"
          }
        ],
        "authorizer": {
          "handler": "allow"
        },
        "mutators": [
          {
            "handler": "noop"
          }
        ]
      },
      {
        "id": "oauth:callback-endpoint",
        "upstream": {
          "preserve_host": true,
          "url": "http://auth-handler.naytife-auth:3000"
        },
        "match": {
          "url": "http://127.0.0.1:8080/callback",
          "methods": [
            "GET"
          ]
        },
        "authenticators": [
          {
            "handler": "anonymous"
          }
        ],
        "authorizer": {
          "handler": "allow"
        },
        "mutators": [
          {
            "handler": "noop"
          }
        ]
      },
      {
        "id": "oauth:logout-endpoint",
        "upstream": {
          "preserve_host": true,
          "url": "http://auth-handler.naytife-auth:3000"
        },
        "match": {
          "url": "http://127.0.0.1:8080/logout",
          "methods": [
            "GET",
            "POST"
          ]
        },
        "authenticators": [
          {
            "handler": "anonymous"
          }
        ],
        "authorizer": {
          "handler": "allow"
        },
        "mutators": [
          {
            "handler": "noop"
          }
        ]
      },
      {
        "id": "oauth:error-endpoint",
        "upstream": {
          "preserve_host": true,
          "url": "http://auth-handler.naytife-auth:3000"
        },
        "match": {
          "url": "http://127.0.0.1:8080/error",
          "methods": [
            "GET"
          ]
        },
        "authenticators": [
          {
            "handler": "anonymous"
          }
        ],
        "authorizer": {
          "handler": "allow"
        },
        "mutators": [
          {
            "handler": "noop"
          }
        ]
      },
      {
        "id": "build:service",
        "upstream": {
          "preserve_host": true,
          "url": "http://cloud-build.naytife-build:9000"
        },
        "match": {
          "url": "http://127.0.0.1:8080/build<**>",
          "methods": ["GET", "POST"]
        },
        "authenticators": [{"handler": "oauth2_introspection"}],
        "authorizer": {"handler": "allow"},
        "mutators": [{"handler": "header"}]
      },
      {
        "id": "backend:templates",
        "upstream": {
          "preserve_host": true,
          "url": "http://backend.naytife:8000"
        },
        "match": {
          "url": "http://127.0.0.1:8080/v1/templates<**>",
          "methods": [
            "GET",
            "POST",
            "PUT",
            "DELETE"
          ]
        },
        "authenticators": [
          {
            "handler": "oauth2_introspection"
          }
        ],
        "authorizer": {
          "handler": "allow"
        },
        "mutators": [
          {
            "handler": "header",
            "config": {
              "headers": {
                "X-User-Id": "{{ print .Subject }}",
                "X-User-Email": "{{ print .Extra.email }}",
                "X-User-Name": "{{ print .Extra.name }}",
                "Access-Control-Allow-Origin": "*",
                "Access-Control-Allow-Methods": "GET, POST, PUT, DELETE, OPTIONS",
                "Access-Control-Allow-Headers": "Authorization, Content-Type"
              }
            }
          }
        ]
      },
      {
        "id": "backend:deployment",
        "upstream": {
          "preserve_host": true,
          "url": "http://backend.naytife:8000"
        },
        "match": {
          "url": "http://127.0.0.1:8080/v1/shops/{shop_id}/deploy<**>",
          "methods": [
            "GET",
            "POST",
            "PUT",
            "DELETE"
          ]
        },
        "authenticators": [
          {
            "handler": "oauth2_introspection"
          }
        ],
        "authorizer": {
          "handler": "allow"
        },
        "mutators": [
          {
            "handler": "header",
            "config": {
              "headers": {
                "X-User-Id": "{{ print .Subject }}",
                "X-User-Email": "{{ print .Extra.email }}",
                "X-User-Name": "{{ print .Extra.name }}",
                "Access-Control-Allow-Origin": "*",
                "Access-Control-Allow-Methods": "GET, POST, PUT, DELETE, OPTIONS",
                "Access-Control-Allow-Headers": "Authorization, Content-Type"
              }
            }
          }
        ]
      },
      {
        "id": "backend:deployment-status",
        "upstream": {
          "preserve_host": true,
          "url": "http://backend.naytife:8000"
        },
        "match": {
          "url": "http://127.0.0.1:8080/v1/shops/{shop_id}/deployment-status<**>",
          "methods": [
            "GET"
          ]
        },
        "authenticators": [
          {
            "handler": "oauth2_introspection"
          }
        ],
        "authorizer": {
          "handler": "allow"
        },
        "mutators": [
          {
            "handler": "header",
            "config": {
              "headers": {
                "X-User-Id": "{{ print .Subject }}",
                "X-User-Email": "{{ print .Extra.email }}",
                "X-User-Name": "{{ print .Extra.name }}",
                "Access-Control-Allow-Origin": "*",
                "Access-Control-Allow-Methods": "GET, POST, PUT, DELETE, OPTIONS",
                "Access-Control-Allow-Headers": "Authorization, Content-Type"
              }
            }
          }
        ]
      },
      {
        "id": "backend:services-health",
        "upstream": {
          "preserve_host": true,
          "url": "http://backend.naytife:8000"
        },
        "match": {
          "url": "http://127.0.0.1:8080/v1/health/services",
          "methods": ["GET"]
        },
        "authenticators": [
          {
            "handler": "anonymous"
          }
        ],
        "authorizer": {
          "handler": "allow"
        },
        "mutators": [
          {
            "handler": "noop"
          }
        ]
      },
      {
        "id": "api:payments",
        "upstream": {
          "preserve_host": true,
          "url": "http://backend.naytife:8000"
        },
        "match": {
          "url": "http://127.0.0.1:8080/v1/payments<**>",
          "methods": ["GET", "POST", "PUT", "DELETE", "PATCH", "OPTIONS"]
        },
        "authenticators": [
          { "handler": "anonymous" }
        ],
        "authorizer": { "handler": "allow" },
        "mutators": [
          { "handler": "noop" }
        ]
      },
      {
        "id": "api:shop-analytics",
        "upstream": {
          "preserve_host": true,
          "url": "http://backend.naytife:8000"
        },
        "match": {
          "url": "http://127.0.0.1:8080/v1/shops/<*>/analytics/<**>",
          "methods": ["GET"]
        },
        "authenticators": [
          { "handler": "oauth2_introspection" }
        ],
        "authorizer": { "handler": "allow" },
        "mutators": [
          {
            "handler": "header",
            "config": {
              "headers": {
                "X-User-Id": "{{ print .Subject }}",
                "Access-Control-Allow-Origin": "*",
                "Access-Control-Allow-Methods": "GET, POST, PUT, DELETE, OPTIONS",
                "Access-Control-Allow-Headers": "Authorization, Content-Type"
              }
            }
          }
        ]
      }
    ]
