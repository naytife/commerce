apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
  name: naytife-ingress
  namespace: naytife-oke-free
  annotations:
    # OCI Load Balancer annotations
    kubernetes.io/ingress.class: "oci-load-balancer"
    oci.oraclecloud.com/load-balancer-type: "lb"
    oci.oraclecloud.com/load-balancer-shape: "flexible"
    oci.oraclecloud.com/load-balancer-shape-flex-min: "10"
    oci.oraclecloud.com/load-balancer-shape-flex-max: "10"
    # SSL/TLS configuration (optional)
    # oci.oraclecloud.com/ssl-ports: "443"
    # Security and performance
    oci.oraclecloud.com/load-balancer-session-persistence-configuration: |
      {
        "cookieName": "naytife-session",
        "disableFallback": false
      }
spec:
  rules:
  # Backend API
  - host: api.naytife-oke.dev
    http:
      paths:
      - path: /
        pathType: Prefix
        backend:
          service:
            name: backend
            port:
              number: 8000
  
  # Authentication Handler  
  - host: auth.naytife-oke.dev
    http:
      paths:
      - path: /
        pathType: Prefix
        backend:
          service:
            name: auth-handler
            port:
              number: 3000
  
  # Hydra Public (OAuth endpoints)
  - host: oauth.naytife-oke.dev
    http:
      paths:
      - path: /
        pathType: Prefix
        backend:
          service:
            name: hydra-public
            port:
              number: 4444
  
  # Oathkeeper (API Gateway)
  - host: gateway.naytife-oke.dev
    http:
      paths:
      - path: /
        pathType: Prefix
        backend:
          service:
            name: oathkeeper-api
            port:
              number: 4456

  # If you want SSL/TLS termination at load balancer
  # tls:
  # - hosts:
  #   - api.naytife-oke.dev
  #   - auth.naytife-oke.dev
  #   - oauth.naytife-oke.dev
  #   - gateway.naytife-oke.dev
  #   secretName: naytife-tls
